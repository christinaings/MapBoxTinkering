<!DOCTYPE html>

<html>
    <head>
        <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
        <script src='https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.js'></script>
        <link href='https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css' rel='stylesheet' />
    </head>
    <body>
        
        <button onclick="addHouseMarker()">add house</button>
        <div id='map' style='width: 100%; height: 75%;'></div>
        <script>
            var markers = [];
            var addingHouseMarker = false;

            var longlat = new mapboxgl.LngLat(-1.2465,51.7612);

            mapboxgl.accessToken = 'pk.eyJ1IjoiY2hyaXN0aW5haW5ncyIsImEiOiJjazhhOW8zazEwMDN1M2VtajcyNjZsZjNvIn0.YoSM_noeQ-7UgRY5UzPY8g';
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v11',
                center: longlat,
                zoom: 10
                
            });

            map.on('click',function(e){
                
                if (!addingHouseMarker)
                    return;

                map.loadImage('url(img/house.png)')
                
                var el = document.createElement('div');
                el.className = 'marker';
                el.style.backgroundImage = 'url(img/house.png)';
                el.style.width = '40px';
                el.style.borderWidth = '50%'
                el.style.height = '40px';

                el.addEventListener('click', function(){
                    window.alert("this worked!")
                })

                var marker = new mapboxgl.Marker(el).setLngLat(e.lngLat).addTo(map);
                console.log(marker)
                map.triggerRepaint()
                addingHouseMarker = false;
                this.markers += (marker);
                }        
            );

            function addHouseMarker(){
                addingHouseMarker = true;
            }
        </script>
    </body>
</html>